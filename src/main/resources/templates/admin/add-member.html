<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}">
<title>गोदावरी नगरपालिका, ललितपुर</title>
<link rel="icon"
	href="https://www.lalitpur15.org/datasys/public/images/favicon.ico"
	type="image/x-icon" />
<link
	href="https://www.lalitpur15.org/datasys/public/plugins/vectormap/jquery-jvectormap-2.0.2.css"
	rel="stylesheet" />
<link
	href="https://www.lalitpur15.org/datasys/public/plugins/simplebar/css/simplebar.css"
	rel="stylesheet" />
<link
	href="https://www.lalitpur15.org/datasys/public/css/bootstrap.min.css"
	rel="stylesheet" />
<link href="https://www.lalitpur15.org/datasys/public/css/animate.css"
	rel="stylesheet" type="text/css" />
<link href="https://www.lalitpur15.org/datasys/public/css/icons.css"
	rel="stylesheet" type="text/css" />
<link
	href="https://www.lalitpur15.org/datasys/public/css/sidebar-menu.css"
	rel="stylesheet" />
<link rel="stylesheet"
	href="https://www.lalitpur15.org/datasys/public/plugins/nepali-datepicker/nepaliDatePicker.min.css">
<link href="https://www.lalitpur15.org/datasys/public/css/app-style.css"
	rel="stylesheet" />
<link rel="stylesheet"
	href="https://www.lalitpur15.org/datasys/public/plugins/datatable/css/datatables.min.css">
<link rel="stylesheet"
	href="https://www.lalitpur15.org/datasys/public/plugins/jquery.steps/css/jquery.steps.css">
<style>
.form-group {
	width: 100%;
}

.wizard>.content {
	background: #fff;
	min-height: 430px;
	margin: 0;
}

.wizard>.content>.body {
	padding: 0;
	width: 100%;
	height: 100%;
}

.member-panel .padding, .member-panel-submit .padding {
	padding: 10px;
}

.wizard>.content>.body label.error {
	margin-left: 0;
}
</style>
<script th:src="@{/assets/js/jquery.min.js}"
	src="assets/js/jquery.min.js"></script>
</head>
<body>
	<div id="wrapper">

		<!--           	Sidebar and header -->
		<div th:replace="~{fragments/admin-sidebar}"></div>
		<header th:replace="~{fragments/header}" class="header1"> </header>


		<div class="clearfix"></div>
		<div class="content-wrapper">
			<div class="container-fluid" id="pjax-container">
				<div class="row pt-2 pb-2">
					<div class="col-sm-9">
						<h4 class="page-title">Data Management System</h4>
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="javaScript:void();">Home</a></li>
							<li class="breadcrumb-item active" aria-current="page">Add
								Member</li>
						</ol>
					</div>
				</div>
				<div class="card">
					<div class="card-body">
						<div class="card-title">Fill up information about family
							members.</div>
						<a href="javascript:void(0)"
							class="add-member btn btn-primary mb-2" style="margin-left: 8px;">Add
							Member</a>
						<th:form:form method="POST" th:action="@{/resident/add}"
							modelAttribute="member" enctype="multipart/form-data">


							<!-- 						<form method="POST" action="javascript:void(0)" data-ajax="true" -->
							<!-- 							th:action="@{/resident/add}" -->
							<!-- 							enctype="multipart/form-data"> -->
							<!-- 							<input type="hidden" name="mainId" th:value="${residentFilledId}"> -->
							<!-- 							<input type="hidden" name="_method" value="post"> -->
							<!-- 							<h2>Member 1</h2> -->
							<fieldset>
								<div class="row member-panel" style="display: flex;">


									<!-- 									<div class="col-lg-4 col-md-4 mb-2"> -->
									<!-- 										<div class="padding"> -->
									<!-- 											<label for="household_id"><h4>कित्ता नं :</h4></label> <select -->
									<!-- 												name="household_id[]" id="household_id" -->
									<!-- 												class="form-control required"> -->




									<!-- 											</select> -->
									<!-- 										</div> -->
									<!-- 									</div> -->


									<div class="col-lg-4 col-md-4 mb-2">
										<div class="padding">
											<label for="name"><h4>नाम थर :</h4></label> <input
												type="text" id="name" name="name"
												class="form-control required" value="">
										</div>
									</div>
									<div class="col-lg-4 col-md-4 mb-2">
										<div class="padding">
											<label for="relation"><h4>नाता :</h4></label> <select
												id="relation" name="relation" class="form-control required">
												<option
													th:each="relation, iteration : ${memberFormDetails.relation}"
													th:value="${iteration.index + 1}" th:text="${relation}"></option>
											</select>
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label for="gender"><h4>लिङ्ग :</h4></label> <select
												id="gender" name="gender" class="form-control required">
												<option
													th:each="gender, iteration : ${memberFormDetails.gender}"
													th:value="${iteration.index + 1}" th:text="${gender}"></option>
											</select>
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label for="age"><h4>उमेर :</h4></label> <input type="text"
												id="age" name="age" class="form-control age required"
												value="">
											<!-- 											<input type="hidden" name="age" class="age" value=""> -->
										</div>
									</div>
									<div class="col-lg-4 col-md-4 mb-2">
										<div class="padding">
											<label for="date_of_birth"><h4>जन्म मिति</h4></label> <input
												type="text" id="date_of_birth" name="date_of_birth"
												class="form-control required" value="">
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label><h4>वैवाहिक स्थिति :</h4></label> <select
												name="marital_status" id="marital_status"
												class="form-control required">
												<option
													th:each="maritalStatus, iteration : ${memberFormDetails.maritalStatus}"
													th:value="${iteration.index + 1}"
													th:text="${maritalStatus}"></option>
											</select>
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label for="education"><h4>सैक्षिक योग्येता</h4></label> <select
												id="education" name="education"
												class="form-control required">
												<option
													th:each="education, iteration : ${memberFormDetails.education}"
													th:value="${iteration.index + 1}" th:text="${education}"></option>
											</select>
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label for="occupation"><h4>पेशा :</h4></label> <input
												type="text" id="occupation" name="occupation"
												class="form-control required" value="">
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label><h4>मतदाता परिचयपत्र :</h4></label> <select
												class="form-control required" name="voter_card"
												id="voter_card">
												<option value="1">छ</option>
												<option value="0">छैन</option>
											</select>
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label><h4>स्थायी ठेगाना :</h4></label> <select
												class="form-control required" name="migration"
												id="migration">
												<option value="1">स्थायी जन्म</option>
												<option value="2">बसाई सराई</option>
											</select>
										</div>
									</div>
									<div class="col-md-4 col-lg-4 mb-2">
										<div class="padding">
											<label for="health"><h4>स्वास्थ्य अवस्था :</h4></label> <input
												type="text" id="health" name="health"
												class="form-control required" value="">
										</div>
									</div>
								</div>
							</fieldset>
							<!-- 								<input type="submit" value="Submit"/> -->
							<button type="submit"
								class="flex-c-m size2 bg1 bo-rad-23 hov1 m-text3 trans-0-4"
								id="member-entry-submit">Add Member</button>
						</th:form:form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<a href="javaScript:void();" class="back-to-top"><i
		class="fa fa-angle-double-up"></i> </a>
	<!--Start footer-->
	<!-- 		<footer th:replace="~{fragments/footer :: footer}"></footer> -->
	<script
		src="https://www.lalitpur15.org/datasys/public/js/popper.min.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/js/bootstrap.min.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/plugins/simplebar/js/simplebar.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/js/sidebar-menu.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/plugins/datatable/js/datatables.min.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/plugins/alerts-boxes/js/sweetalert.min.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/js/jquery.pjax.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/js/sidebar-menu.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/plugins/nepali-datepicker/jquery.nepaliDatePicker.min.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/js/app-script.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/plugins/jquery.steps/js/jquery.steps.min.js"></script>
	<script
		src="https://www.lalitpur15.org/datasys/public/plugins/jquery-validation/js/jquery.validate.min.js"></script>
	<!-- <script type="text/javascript" src="http://www.google.com/jsapi"></script> -->
	<script
		src="https://www.lalitpur15.org/datasys/public/js/transliteration.I.js"></script>
	<script src="https://www.lalitpur15.org/datasys/public/js/app.js"></script>

	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
	<div id="scripts">
		<script th:inline="javascript">
			/*<![CDATA[*/
			var mainId = /*[[${residentFilledId}]]*/'0';

			/*]]>*/

			let contextPath = /*[[${#request.contextPath}]]*/'/admin';

			$(function() {
				var token = $("meta[name='_csrf']").attr("content");
				var header = $("meta[name='_csrf_header']").attr("content");
				$(document).ajaxSend(function(e, xhr, options) {
					xhr.setRequestHeader(header, token);
				});
			});

			$(function() {
				$("#member-entry-submit").click(function(event) {
					//Getting the data from the formm	
					let memberName = $("#name").val();
					let relation = $("#relation").val();
					let gender = $("#gender").val();
					let age = $("#age").val();
					let dateOfBirth = $("#date_of_birth").val();
					let maritalStatus = $("#marital_status").val();
					let education = $("#education").val();
					let occupation = $("#occupation").val();
					let voterCard = $("#voter_card").val();
					let migration = $("#migration").val();
					let healthStatus = $("#health").val();
					let familyId = mainId;
					let memberInfo = {};
					memberInfo.name = memberName;
					memberInfo.relation = relation;
					memberInfo.gender = gender;
					memberInfo.age = age;
					memberInfo.dateOfBirth = dateOfBirth;
					memberInfo.maritalStatus = maritalStatus;
					memberInfo.education = education;
					memberInfo.occupation = occupation;
					memberInfo.voterCard = voterCard;
					memberInfo.address = migration;
					memberInfo.healthCondition = healthStatus;
					memberInfo.mainId = familyId;

					// Now create an ajax request to send member details to the server
					$.ajax({
						method : "POST",
						url : contextPath + "/resident/add",
						data : JSON.stringify(memberInfo),
						contentType : "Application/Json",
						success : function(result) {
							swal.fire({
								text : result.data,
								icon : "success",
								closeOnClickOutside : false,
								closeOnEsc : false
							}).then(function() {
								window.location = contextPath + "/super-admin";
							});
						},
						error : function(error) {
						}
					});
				});
			});
		</script>
	</div>
</body>
</html>
