<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}">
<title>गोदावरी नगरपालिका, ललितपुर</title>
<!--favicon-->
<link rel="icon" th:href="@{/assets/images/favicon1.ico}"
	href="assets/images/favicon1.ico" type="image/x-icon" />
<link th:href="@{/assets/plugins/vectormap/jquery-jvectormap-2.0.2.css}"
	href="assets/plugins/vectormap/jquery-jvectormap-2.0.2.css"
	rel="stylesheet" />
<link th:href="@{/assets/plugins/simplebar/css/simplebar.css}"
	href="assets/plugins/simplebar/css/simplebar.css" rel="stylesheet" />
<link th:href="@{/assets/css/bootstrap.min.css}"
	href="assets/css/bootstrap.min.css" rel="stylesheet" />
<link th:href="@{/assets/css/animate.css}" href="assets/css/animate.css"
	rel="stylesheet" type="text/css" />
<link th:href="@{/assets/css/icons.css}" href="assets/css/icons.css"
	rel="stylesheet" type="text/css" />
<link th:href="@{/assets/css/sidebar-menu.css}"
	href="assets/css/sidebar-menu.css" rel="stylesheet" />
<link th:href="@{/assets/css/app-style.css}"
	href="assets/css/app-style.css" rel="stylesheet" />


<link rel="stylesheet"
	th:href="@{/assets/plugins/nepali-datepicker/nepaliDatePicker.min.css}"
	href="assets/plugins/nepali-datepicker/nepaliDatePicker.min.css">


<link rel="stylesheet"
	th:href="@{/assets/plugins/datatable/datatables.min.css}"
	href="assets/plugins/datatable/datatables.min.css">

<link rel="stylesheet"
	th:href="@{/assets/plugins/jquery.steps/css/jquery.steps.css}"
	href="assets/plugins/jquery.steps/css/jquery.steps.css">

<link rel="stylesheet" type="text/css"
	href="https://www.lalitpur15.org/datasys/public/css/print.css"
	media="print">
<link rel="stylesheet" th:href="@{/assets/css/leaflet.css}" />


<style type="text/css">
.printForm .first_cell {
	width: 30px;
}

.printForm td, span {
	font-size: 13px;
	position: relative;
}

.table thead th {
	font-size: 13px;
}

.printForm [type="checkbox"]:not (:checked )+span, .printForm [type="radio"]:not
	 (:checked )+span {
	display: none;
}
/* Base for span styling */
.printForm [type="checkbox"]:not (:checked ), .printForm [type="checkbox"]:checked,
	.printForm [type="radio"]:not (:checked ), .printForm [type="radio"]:checked
	{
	position: absolute;
	left: -9999px;
}

.green {
	background: green !important;
	color: #fff;
}

.red {
	background: red !important;
	color: #fff;
}

.ui.grid {
	margin-right: 0;
	margin-left: 0;
	width: 100%;
}

.table-borderless td {
	border: none;
}

#surveyMap {
	height: 70em;
	width: 95em;
}
</style>
</head>
<body>
	<div id="wrapper">
		<!-- Side bar and header -->
		<div th:replace="~{fragments/private-sidebar :: private-sidebar}"></div>
		<header th:replace="~{fragments/header :: header}" class="header1">
		</header>
		<div class="clearfix"></div>
		<div class="content-wrapper"
			th:if="${residentFullDetail != null && residentFullDetail.residentDetail != null}">
			<div class="container-fluid" id="pjax-container">
				<div class="row pt-2 pb-2">
					<div class="col-sm-6">
						<h4 class="page-title"
							th:text="${residentFullDetail.residentDetail.answer1} + ' को पूर्ण विवरण'">Godawari
							Nagarpalika Full Detail</h4>
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="javaScript:void();">Home</a></li>
							<li class="breadcrumb-item active" aria-current="page">Household
								Members List</li>
						</ol>
					</div>
					<div class="col-sm-6">
						<div class="pull-right">
							<!-- Button for showing the modal for Map Location  -->
							<button id="view-location-btn"
								class="block2-user-id btn btn-success">यस स्थान
								मानचित्रमा हेर्नुहोस</button>
							<!-- Button for adding family member  -->
							<a
								th:href="@{/resident/} + ${residentFullDetail.residentDetail.filledId} +'/member/'"><button
									sec:authorize="hasAnyRole('CENTRAL_ADMIN', 'WARD_ADMIN', 'SURVEYOR')"
									class="btn btn-xs btn-primary">Add Family Member</button></a>

							<!-- Button for printing data  -->
							<!-- 						<div class="btn-print"> -->
							<button id="print" class="btn btn-primary">Print this
								page</button>
							<!-- 						</div> -->
						</div>
					</div>
				</div>
				<div class="saibu-display-form print table-responsive printForm">
					<div class="data-heading-row">
						<div class="row">
							<div class="col-lg-2 col-md-12">
								<a th:href="${residentFullDetail.residentDetail.answer51}"
									style="display: block" target="_blank" class="no-pjax"><img
									th:src="${residentFullDetail.residentDetail.answer51}"
									class="media-object house-detail-photo"
									style="width: 150px; height: 150px;"></a>
							</div>
							<div class="col-lg-10 col-md-12">
								<table class="table">
									<tbody>
										<tr>
											<td><strong>घरमुलीको नाम</strong> :</td>
											<td th:text="${residentFullDetail.residentDetail.answer1}"></td>
											<td><strong>टोल</strong> :</td>
											<td th:text="${residentFullDetail.residentDetail.answer2}"></td>
											<td><strong>घर नं</strong> :</td>
											<td th:text="${residentFullDetail.residentDetail.answer4}"></td>
											<td><strong>फोन नं</strong> :</td>
											<td th:text="${residentFullDetail.residentDetail.answer5}"></td>
										</tr>
										<tr>
											<td><strong>बुबाको नाम</strong>:</td>
											<td th:text="${residentFullDetail.residentDetail.answer6}">दुर्गा
												बहादुर राउत</td>
											<td><strong>आमाको नाम</strong>:</td>
											<td th:text="${residentFullDetail.residentDetail.answer7}">कान्छी
												राउत</td>
											<td><strong>मातृभाषा</strong>:</td>
											<td th:text="${residentFullDetail.residentDetail.answer8}">नेपाली</td>
											<td><strong>जाति</strong>:</td>
											<td th:text="${residentFullDetail.residentDetail.answer9}">ब्रहमण/क्षेत्री</td>
										</tr>
										<tr>
											<td><strong>धर्म</strong>:</td>
											<td th:text="${residentFullDetail.residentDetail.answer10}">हिन्दू
												धर्म</td>
											<td><strong>नागरिकता नं</strong>:</td>
											<td th:text="${residentFullDetail.residentDetail.answer11}">१३/१६४१</td>
											<td><strong>नागरिकता लिएको जिल्ला</strong>:</td>
											<td th:text="${residentFullDetail.residentDetail.answer12}">ललितपुर</td>
											<td></td>
											<td></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-12 col-md-12">
							<div class="table-responsive">
								<table class="table table-striped table-hover table-member"
									id="grid"
									th:if="${residentFullDetail.familyMembers != null && #lists.size(residentFullDetail.familyMembers) > 0}">
									<thead>
										<tr>
											<th rowspan="2"><strong>ऋ.स</strong></th>
											<th><strong>१</strong></th>
											<th><strong>२</strong></th>
											<th><strong>३</strong></th>
											<th><strong>४</strong></th>
											<th><strong>५</strong></th>
											<th><strong>६</strong></th>
											<th><strong>७</strong></th>
											<th><strong>८</strong></th>
											<th><strong>९</strong></th>
											<th><strong>१० </strong></th>
											<th><strong>११ </strong></th>
											<th rowspan="2" class="rm-print"><strong>#</strong></th>
										</tr>
										<tr>
											<th><strong>नाम थर</strong></th>
											<th><strong>नाता</strong></th>
											<th><strong>लिङ्ग</strong></th>
											<th><strong>उमेर</strong></th>
											<th><strong>वैवाहिक<br> स्थिति
											</strong></th>
											<th><strong>सैक्षिक योग्येता</strong></th>
											<th><strong>पेशा</strong></th>
											<th><strong>मतदाता<br> परिचयपत्र
											</strong></th>
											<th><strong>स्थायी ठेगाना</strong></th>
											<th><strong>स्वास्थ्य अवस्था</strong></th>
											<th><strong>कार्यहरू</strong></th>
										</tr>
									</thead>
									<tbody>
										<tr
											th:each="member,iteration: ${residentFullDetail.familyMembers}">
											<td th:text="${iteration.index + 1}">1</td>
											<td th:text="${member.name}"></td>
											<td th:text="${member.relation}"></td>
											<td th:text="${member.gender}"></td>
											<td th:text="${member.age}"></td>
											<td th:text="${member.maritalStatus}"></td>
											<td th:text="${member.education}"></td>
											<td th:text="${member.occupation}"></td>
											<td th:text="${member.voterCard} == 'true' ? 'छ' : 'छैन'"></td>
											<td
												th:text="${member.address} == 1 ? 'स्थायी जन्म' : 'बसाई सराई' "></td>
											<td th:text="${member.healthCondition}"></td>
											<td><a href="#"
												th:href="@{/resident/member/} + ${member.memberId}"
												class="btn btn-xs btn-success">Edit Details</a>
												<button
													sec:authorize="hasAnyRole('CENTRAL_ADMIN', 'WARD_ADMIN', 'SURVEYOR')"
													class="btn btn-xs btn-warning"
													th:attr="onclick=|deleteMemberInfo('${member.memberId}')|">
													Delete</button> <a href="#" th:data="${member.memberId}"
												class="btn btn-xs btn-danger">Mark Demise</a>
											<td>
										</tr>
									</tbody>
								</table>
								<table
									th:if="${residentFullDetail.familyMembers == null || #lists.isEmpty(residentFullDetail.familyMembers)}">
									<thead>
										<tr>
											<td><h2>माफ गर्नुहोला | परिवारको कुनै पनि सदस्य
													भेटीएन वा प्रणालीमा बिवरण राखिएको छैन |</h2></td>
										</tr>
									</thead>
								</table>
							</div>
							<!-- 												<a th:href="@{/resident/} + ${residentFullDetail.residentDetail.filledId} +'/member/'"><button sec:authorize="hasAnyRole('CENTRAL_ADMIN', 'WARD_ADMIN', 'SURVEYOR')" class="btn btn-xs btn-primary pull-right"> -->
							<!-- 												Add Family Member -->
							<!-- 												</button></a> -->
						</div>
					</div>
					<div class="row">
						<div class="col-lg-12 col-md-12">
							<div class="table-responsive">
								<table class="table table-striped table-member">
									<tbody>
										<tr>
											<td>११. <strong>कित्ता </strong>: <strong
												th:text="${residentFullDetail.residentDetail.answer13}"></strong></td>
											<td><strong>घर संख्या</strong>: <strong
												th:text="${residentFullDetail.residentDetail.answer14}"></strong></td>
											<td><strong>व्यवसाय</strong>: <strong
												th:text="${residentFullDetail.residentDetail.answer15}"></strong></td>
											<td><strong>व्यवसायी</strong>: <strong
												th:text="${residentFullDetail.residentDetail.answer16}">
											</strong> <strong>फोन नं</strong>: <strong
												th:text="${residentFullDetail.residentDetail.answer17}">
											</strong></td>
										</tr>
										<tr>
											<td>१२. <strong>घरको तल्ला</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer18}"></td>
											<td>१३. <strong>पानी</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer19}"></td>
										</tr>
										<tr>
											<td>१४. <strong>निकासा</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer20}"></td>
											<td>१५. <strong>सवारी साधन</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer21}"></td>
										</tr>
										<tr>
											<td>१६. <strong>घरको बनोैट</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer22}"></td>
											<td>१७. <strong>घरको जगको प्रकार</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer23}"></td>
										</tr>
										<tr>
											<td>१८. <strong>सडकको भौतिक अवस्था</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer24}"></td>
											<td>१९. <strong>बैदेशिक रोजगार</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer32}"></td>
										</tr>
										<tr>
											<td>२०. <strong>बैदेशिक अध्ययन</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer33}"></td>
											<td>२१. <strong>१६ वर्ष सम्मका बालबालिका<br>अन्य
													ठाउँमा काम गर्न गएका छन
											</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer34}"></td>
										</tr>
										<tr>
											<td>२२. <strong>घरबाट उत्पादन भएको <br>पोहोरका
													व्यवस्था
											</strong></td>
											<td th:text="${residentFullDetail.residentDetail.answer35}"></td>
											<td>२३. <strong>बती</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer36}"></td>
										</tr>
										<tr>
											<td>२४. <strong>खाना पकाउन प्रयोग हुने इन्धन</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer37}"></td>
											<td>२५. <strong>संचार सुविधा</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer38}"></td>
										</tr>
										<tr>
											<td>२६. <strong>घर जग्गाको विवरण</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer39}"></td>
											<td>२७. <strong>वार्षिक आम्दानी</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer40}"></td>
										</tr>
										<tr>
											<td>२८. <strong>वार्षिक खर्च</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer41}"></td>
											<td>२९. <strong>चौपाया तथा पशुपंशी</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer42}"></td>
										</tr>
										<tr>
											<td>३०. <strong>आफ्नो उत्पादन तथा आय स्रोतले
													कति महिना खान पुग्छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer43}"></td>
											<td>३१. <strong>सिप तालिम पहिला लिनुभएको छ? </strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer44}"></td>
										</tr>
										<tr>
											<td>३२. <strong>भविष्यमा कस्तो सिप तालिम गर्नु
													पर्ला? </strong>:
											</td>
											<td colspan="3"
												th:text="${residentFullDetail.residentDetail.answer45}"></td>
										</tr>
										<tr>
											<td>३३ . <strong>तपाईको परिवारमा १८ वर्षभन्दा कम उमेरका भिन्न शारीरिक तथा मानसिक क्षमता भएका(अपाङ्ग) सदस्यहरु (बालक)</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer52}"></td>
											<td>३४ . <strong>तपाईको परिवारमा १८ वर्षभन्दा कम उमेरका भिन्न शारीरिक तथा मानसिक क्षमता भएका(अपाङ्ग) सदस्यहरु (बालिका)</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer53}"></td>
										</tr>
										<tr>
											<td>३५ . <strong>परिवारको कुनै सदस्य विरामी भएमा उपचारका लागि सबैभन्दा पहिला कहाँ जानुहुन्छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer54}"></td>
											<td>३६ . <strong>बिचैमा विद्यालय जान छोडेका ६ - १५ वर्ष उमेर समुहका बालबालिकाहरुका संख्या</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer55}"></td>
										</tr>
										<tr>
											<td>३७ . <strong>बाल विकास केन्द्र वा पुर्व प्रा.वि. तहमा जाने ३ देखि ५ वर्षसम्मका बालबालिका संख्या</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer56}"></td>
											<td>३८ . <strong>तपाईको परिवारमा बालबालिकाले गल्ति गरेमा के गर्नु हुन्छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer57}"></td>
										</tr>
										<tr>
											<td>३९ .<strong>तपाईको घरमा छोरा र छोरीमा कुनै फरक व्यवहार गर्ने गर्नुभएको छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer58}"></td>
											<td>४० .<strong>तपाईको परिवारका बालबालिकाहरुले विद्यालयमा गल्ती गरेमा विद्यालयमा निम्न यातना पाउने गरेका छन् ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer59}"></td>
										</tr>
										<tr>
											<td>४१ .<strong>तपाईले बालबालिकालाई वर्षमा कति जोर लुगा दिनुहुन्छ? (सरदर)</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer60}"></td>
											<td>४२ .<strong>तपाईको परिवारको बालबालिकाहरुमा यौनशोषणको कुनै घटना घटेको छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer61}"></td>
										</tr>
										<tr>
											<td>४३ .<strong>तपाईलाई बाल अधिकारको बारेमा जानकारी छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer62}"></td>
											<td>४४ .<strong>परिवारमा बालबालिकासँग सम्बन्धित कुनै विषयमा निर्णय गर्दा उनीहरुलाई पनि सहभागी गराउने गर्नु भएको छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer63}"></td>
										</tr>
										<tr>
											<td>४५ .<strong>तपाईको परिवारका कुनै बालबालिका बालगृह वा कुनै संस्थामा बसेका छन्?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer64}"></td>
											<td>४६ .<strong>तपाईको परिवारका कुनै बालबालिका सडक बालबालिकाको रुपमा रहेका छन्?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer65}"></td>
										</tr>
										<tr>
											<td>४७ .<strong>तपाईको परिवारका बालबालिकाहरु ‍बाल क्लव/संगठन आदिमा आवद्धता रहेको छ? (सकेसम्म सम्बन्धित बालबालिकाहरुसँग पनि सोध्ने)</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer66}"></td>
											<td>४८ .<strong>तपाईलाई बालरोग तथा खोपहरुको जानकारी छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer67}"></td>
										</tr>
										<tr>
											<td>४९ .<strong>तपाईको परिवारका बालबालिका पढ्ने विद्यालायमा अपाङ्गता भएका विद्यार्थीका लागि विशेष शिक्षाको सुविधा छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer68}"></td>
											<td>५०.<strong>तपाईको परिवारमा निम्न कार्यहरु प्राय कसले गर्दछ? (महिला वा पुरुष)</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer69}"></td>
										</tr>
										<tr>
											<td>५१ .<strong>एक वर्षभित्र तपाईको परिवारमा महिला तथा बालबालिका उपर हिंसा सम्बन्धी निम्न कुनै घटना घटेका छन/छैनन्?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer70}"></td>
											<td>५२ .<strong>बितेको १ वर्षभित्र तपाईको परिवारमा ५ वर्षमुनिका कुनै बालबालिकाको मृत्यु भएको छ?</strong>:
											</td>
											<td th:text="${residentFullDetail.residentDetail.answer71}"></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-12 col-md-12">
							<div class="table-responsive">
								<table class="table table-bordered  table-member">
									<tbody>
										<tr>
											<td><strong>कागजातहरू</strong>:</td>
											<td><span>नागरिकता</span><a
												th:href="${residentFullDetail.residentDetail.answer46}"
												target="blank"><img
													th:src="${residentFullDetail.residentDetail.answer46}"
													style="display: block; height: 300px; width: 300px"
													class="img-thumbnail photo"
													th:onerror="'this.src=\'' + @{/assets/images/no-image.png} + '\';'"></a></td>
											<td><span>नाता प्रमाण-पत्र</span><a
												th:href="${residentFullDetail.residentDetail.answer47}"
												target="blank"><img
													th:src="${residentFullDetail.residentDetail.answer47}"
													style="display: block; height: 300px; width: 300px"
													class="img-thumbnail photo"
													th:onerror="'this.src=\'' + @{/assets/images/no-image.png} + '\';'"></a></td>
											<td><span>पास भएको घरको नक्सा</span><a
												th:href="${residentFullDetail.residentDetail.answer48}"
												target="blank"><img
													th:src="${residentFullDetail.residentDetail.answer48}"
													style="display: block; height: 300px; width: 300px"
													class="img-thumbnail photo"
													th:onerror="'this.src=\'' + @{/assets/images/no-image.png} + '\';'"></a></td>
											<td><span>अन्य कागजात</span><a
												th:href="${residentFullDetail.residentDetail.answer49}"
												target="blank"><img
													th:src="${residentFullDetail.residentDetail.answer49}"
													style="display: block; height: 300px; width: 300px"
													class="img-thumbnail photo"
													th:onerror="'this.src=\'' + @{/assets/images/no-image.png} + '\';'"></a></td>
										</tr>
									</tbody>
								</table>
								<table class="table table-bordered  table-member">
									<tbody>
										<tr>

											<td><strong>विवरण दिने : </strong> <span
												th:text="${residentFullDetail.residentDetail.answer1}">
											</span></td>
											<td><strong>मिति : </strong><span
												th:text="${residentFullDetail.residentDetail.entryDate}"></span></td>
											<td><strong>तथ्यांक संकलन : </strong> <span
												th:text="${residentFullDetail.surveyor}"></span></td>

										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>

				<!-- Modal View For Map Location Display-->
				<div class="modal fade" id="map-location-modal"
					data-keyboard="false" data-backdrop="false" role="dialog"
					aria-hidden="true">
					<div class="modal-dialog modal-lg modal-dialog-centered"
						role="document">
						<div class="modal-content" style="border-radius: 10px;">
							<div class="modal-header">
								<h5 class="modal-title">
									<b><span
										th:text=${residentFullDetail.residentDetail.answer1}></span>
										को बासस्थान|</b>
								</h5>
								<button id="cancel-location-btn"
									class="btn btn-danger pull-right">
									<b>X</b>
								</button>
							</div>
							<div class="modal-content-body">
								<div class="row">
									<!-- 								<div class="row" style="margin: 5px 20px;"> -->
									<!-- 									<div style="margin: 20px auto;"> -->
									<div>
										<div id="surveyMap"></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- 				<div class="btn-print"> -->
				<!-- 					<button id="print" class="btn btn-primary">Print this page</button> -->
				<!-- 				</div> -->

				<div class="modal fade" id="deth-record-modal" data-keyboard="false"
					data-backdrop="false" role="dialog" aria-hidden="true">
					<div class="modal-dialog modal-lg modal-dialog-centered"
						role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Death Record.</h5>
							</div>
							<div class="modal-body">
								<form>
									<input type="hidden" id="memberId" name="memberId" />
									<div class="form-group">
										<label for="regNumber" class="control-label">Registration Number</label>
										<div class="row">
											<div class="col-md-6">
												<input type="text" class="form-control" id="regNumber">
											</div>
											<div class="col-md-4">
												<button class=" btn btn-success" id="regCodeBtn">Generate Code</button>
											</div>
										</div>
									</div>
									<div class="form-group">
										<label for="deathCause" class="control-label">Death Cause</label>
										<input type="text" class="form-control" id="deathCause">
									</div>
									<div class="form-group">
										<label for="date" class="control-label">Date</label>
										<input type="date" class="form-control" id="date" />
									</div>
									<div class="form-group">
										<label for="place" class="control-label">Place</label>
										<input type="text" class="form-control" id="place">
									</div>
								</form>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-default"
									data-dismiss="modal">Close</button>
								<button type="button" id="death-record-submit-btn" class="btn btn-primary">Submit</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<footer th:replace="~{fragments/footer :: footer}"></footer>
	</div>
	<div th:replace="~{fragments/scripts :: scripts}"></div>
	<script th:src="@{/assets/js/leaflet.js}"></script>
	<script th:src="@{/assets/js/printThis.js}"
		src="assets/js/printThis.js"></script>
	<script th:inline="javascript">
		/*<![CDATA[*/
		var geoCoordinates = /*[[${residentFullDetail.residentDetail.answer50}]]*/'0';

		/*]]>*/
		
			/*<![CDATA[*/
			var residentFullDetail = /*[[${residentFullDetail}]]*/'';
			
			/*]]>*/
		var token = /*[[${#authentication.principal.token}]]*/ '';
		$(function() {
			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			$(document).ajaxSend(function(e, xhr, options) {
				xhr.setRequestHeader(header, token);
			});
		});
		
		
		//Splitting the location coordinates into latitude and longitude
		var geoFields = geoCoordinates.split(', ');

		var geoLat = geoFields[0]; //Gets the latitude
		var geoLong = geoFields[1]; //Gets the longitude

		//JS function for displaying the location of the household using leafletjs
		const mymap = L.map('surveyMap').setView([ geoLat, geoLong ], 20);
		var marker;
		// 			var layerGroup = L.layerGroup().addTo(mymap);

		const attribution = '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors';

		// 			const tileUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
		// 			const tiles = L.tileLayer(tileUrl, {attribution});
		// 			tiles.addTo(mymap);

		L.tileLayer('http://{s}.google.com/vt/lyrs=y,h&x={x}&y={y}&z={z}', {
			attribution : 'Map data &copy; 2020 Google',
			maxZoom : 20,
			subdomains : [ 'mt0', 'mt1', 'mt2', 'mt3' ]
		}).addTo(mymap);

		marker = L.marker([ geoLat, geoLong ]).addTo(mymap).bindPopup("Record ID = " + residentFullDetail.residentDetail.filledId);
		
		//For showing the Map modal	
		$("#view-location-btn").on("click", function(event) {
			event.preventDefault();
			$("#map-location-modal").modal("show");
			setTimeout(function() {
				mymap.invalidateSize();
			}, 20)
		});

		//For canceling and hiding the Map modal
		$("#cancel-location-btn").on("click", function(event) {
			$("#map-location-modal").modal("hide");
		});

		//Prints the resident details
		$(function() {
			$('#print').click(function() {
				$('.saibu-display-form').printThis({
					importCSS : false,
					loadCSS : "/assets/css/print.css",
					removeInline : true
				});
			});
		});
		
		//converts date to mm-dd-yyyy form
		function convertDate(rawDate) {
			let date = rawDate.split("/");
			let arrayLength = date.length;
			let finalDate = "";
			for(let i = 0; i < arrayLength; i++) {
				if(i == (arrayLength -1)) {
					finalDate += date[i];
				} else {
					finalDate += date[i] + "-";
				}
			}
			return finalDate;
		}
		
		//Set death record request
		$("#grid td").on('click', "a", function(event) {
			if($(this).text() === 'Mark Demise') {
				let memberId = $(this).attr("data") || false;
				$("#memberId").val(memberId);
				$("#deth-record-modal").modal("show");
			}
		});
		
		$("#death-record-submit-btn").on("click", function(event) {
			event.preventDefault();
			var memberId = $("#memberId").val();
			var registrationNumber = $("#regNumber").val();
			var deathCause =  $("#deathCause").val();
			var demiseDate =  $("#date").val();
			var place =  $("#place").val();
			
			let deathRecord = {};
			deathRecord.memberId = memberId;
			deathRecord.registrationNumber = registrationNumber;
			deathRecord.deathCause = deathCause;
			deathRecord.demiseDate = convertDate(demiseDate);
			deathRecord.place = place;
			
			$.ajax({
				url: "http://localhost:8888/resident/member/dead",
				method: "POST",
				contentType: "Application/Json",
				headers: {
					"Authorization": token
				},
				data: JSON.stringify(deathRecord),
				success: function(data) {
					swal.fire({
						  text: "Member marked as demise!",
						  icon: "success",
						  buttons: true,
						  dangerMode: true,
						})
						.then((willDelete) => {
						 location.reload();
					});
				},
				error: function(data) {
					console.log(data);
				}
			});
		});
		
		//For canceling and hiding the Map modal
		$("#deth-record-cancel").on("click", function(event) {
			$("#deth-record-modal").modal("hide");
		});
		
		
		//Generate Random Code For Registration.
		function generatePassword() {
			return (Math.random().toString(36).slice(2)
					+ Math.random().toString(36).toUpperCase().slice(2)).toUpperCase();
		}
		
		$("#regCodeBtn").on("click", function(event) {
			event.preventDefault();
			$("#regNumber").val(generatePassword());
		});
		
		// For deleting favPlace
		function deleteMemberInfo(memberId) {
			swal.fire({
				title : 'Are you sure you want to delete this member?',
				text : "You won't be able to revert this!",
				icon : 'warning',
				showCancelButton : true,
				confirmButtonColor : '#3085d6',
				cancelButtonColor : '#d33',
				confirmButtonText : 'Yes, delete it!'
			}).then((btnClicked) => {
				if(btnClicked.value) {
					swal.fire({
						title : 'Are you sure absolutely sure?',
						text : "This action cannot be reverted!",
						icon : 'warning',
						showCancelButton : true,
						confirmButtonColor : '#3085d6',
						cancelButtonColor : '#d33',
						confirmButtonText : 'Yes, delete it!'
					}).then((btnClicked) => {
						if(btnClicked.value) {
							$.ajax({
								url : contextPath + "/resident/" + memberId,
								method : "DELETE",
								success : function(data) {
									swal.fire({
										icon : "success",
										text : "The family member has been removed"
									}).then((btnClick) => {
										if(btnClick.value) {
											location.reload(true);		
										}
									});
								}
							});
						}
					});
				}
			});
		}
	</script>
</body>
</html>
